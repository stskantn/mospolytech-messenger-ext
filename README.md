# Mospolytech Messenger v1.0.18

## Что изменилось в версии 1.0.18

### Добавлена функция выгрузки ID студентов ✨

После поиска всех студентов из файла теперь можно:
- **Выгрузить модифицированный файл** с добавленной колонкой "ID в ЛК" и "Статус"
- Файл сохраняется в том же формате, что был загружен (XLSX → XLSX, TXT → TXT, CSV → CSV)
- Автоматическое именование: `original_name_with_ids.xlsx`

**Как использовать:**
1. Загрузите файл со студентами
2. Нажмите "Найти получателей" и дождитесь завершения поиска
3. Кнопка "Выгрузить ID студентов" станет активной
4. Нажмите её для скачивания обновлённого файла

**Формат выгруженного файла:**
| ФИО | Группа | ID в ЛК | Статус |
|-----|--------|---------|--------|
| Иванов Иван | 251-621 | 123456 | найден |
| Петров Петр | 252-631 | 123457 | найден (точное ФИО) |
| Сидоров Семен | 253-641 | | не найден |

## Что было в версии 1.0.17

### Добавлена поддержка новых форматов файлов:

1. **Excel (XLSX, XLS)** - теперь можно загружать файлы напрямую из Excel без конвертации
2. **Текст Юникод (TXT)** - поддержка файлов, сохраненных в MS Office 2013 как "Текст Юникод"
3. **CSV UTF-8** - по-прежнему поддерживается

### Как использовать:

#### Вариант 1: Excel файл (XLSX)
1. Создайте таблицу в Excel с двумя столбцами:
   - **ФИО** (или первый столбец)
   - **Группа** (или второй столбец)
2. Сохраните файл как `.xlsx`
3. Загрузите в расширение

#### Вариант 2: Текст Юникод (TXT) - для MS Office 2013
1. Создайте таблицу в Excel с двумя столбцами:
   - **ФИО** (или первый столбец)
   - **Группа** (или второй столбец)
2. Нажмите `Файл` → `Сохранить как`
3. В списке типов файлов выберите: **"Текст Юникод (*.txt)"**
4. Сохраните файл
5. Загрузите в расширение

#### Вариант 3: CSV UTF-8 (для новых версий Excel)
1. Создайте таблицу в Excel с двумя столбцами
2. Нажмите `Файл` → `Сохранить как`
3. Выберите тип: **"CSV UTF-8 (разделитель — запятая)"**
4. Сохраните файл
5. Загрузите в расширение

### Формат данных

Файл должен содержать минимум два столбца:

| ФИО | Группа |
|-----|--------|
| Иванов Иван Иванович | 251-621 |
| Петров Петр Петрович | 252-631 |

**Примечания:**
- Первая строка считается заголовком и пропускается
- Столбцы могут называться "ФИО" и "Группа" или быть без названий
- Столбцы могут быть разделены: запятой, точкой с запятой или табуляцией
- Расширение автоматически определит формат файла

### Технические детали

- Используется библиотека **SheetJS (xlsx)** для чтения Excel файлов
- Поддержка кодировки UTF-16 LE (BOM) для TXT файлов
- Автоматическое определение разделителя в CSV файлах
- Улучшенная обработка ошибок при чтении файлов

### Установка расширения

1. Скопируйте все файлы расширения в одну папку
2. Откройте Chrome/Edge и перейдите в `chrome://extensions/`
3. Включите "Режим разработчика" в правом верхнем углу
4. Нажмите "Загрузить распакованное расширение"
5. Выберите папку с файлами расширения

### Файлы расширения

- `manifest.json` - манифест расширения (обновлена версия)
- `popup.html` - интерфейс расширения (добавлена кнопка экспорта)
- `popup.js` - основная логика (добавлены функции экспорта в разных форматах)
- `popup.css` - стили (обновлены отступы для кнопок)
- `background.js` - фоновый скрипт (без изменений)
- `content.js` - скрипт для работы с ЛК (без изменений)
- `fonts.css` - шрифты (без изменений)
- Иконки и изображения (требуется download-icon.svg)

### Поддержка

Если возникнут проблемы с чтением файлов:
1. Проверьте, что в файле есть заголовок в первой строке
2. Проверьте, что данные начинаются со второй строки
3. Убедитесь, что файл содержит как минимум столбцы ФИО и Группа
4. Откройте логгер (кликните на "Версия:" внизу) для просмотра ошибок
